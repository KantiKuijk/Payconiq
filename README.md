# Payconiq

## **Node.js implementation for interacting with the Payconiq V3 API**

> _Disclaimer: this is not an official package from Payconiq International or any affiliated owners of a Payconiq brand. This is my own implementation following the [API Docs](https://developer.payconiq.com). In no way do I make any guarantees that this code is valid, safe, or well-written. That being said, I wrote this code for my own use, and if you want to use it in your project(s), you're free to do so._

## Classes

There are three classes exported: `Payconiq`, `PayconiqAPI`, and `PayconiqTest`.

1. `Payconiq(paymentId[, opts])` can be used for all actions that only need a `paymentId` but no `apiKey`.
2. `PayconiqAPI(apiKey, paymentId[, opts])` can be used for all actions. It extends `Payconiq` and points to production endpoints (PROD or production environment).
3. `PayconiqTest(apiKey, paymentId[, opts])` can be used for all actions. It extends `Payconiq` and points to test endpoints (EXT or external environment).

The `paymentId` needs to be a string of exactly 24 characters long.

The `apiKey` needs to be a string of exactly 36 characters long.

The `opts` is an object containing two optional entries:

- `callbackURL` (string): used to verify incoming callbacks from Payconiq servers in the `verifyCallback` method. Is overriden when a `callbackUrl` is passed to the `verifyCallback` method itself.
- `defQRCodeOpts`: default options for customizing QR-codes generated by the instance.

> Everywhere a Payconiq QR-code is generated, an object to customize it can be passed in too. This object can contain any of the following entries, all of them being optional (Payconiq should default the the first one for every option: a small magenta png):
>
> - format: `"PNG"`, or `"SVG"`
> - size: `"S"`, `"M"`, `"L"`, `"XL"`
> - color: `"magenta"` or `"black"`

_Note: The incompatibility of the constructor arguments between `Payconiq` and `PayconiqAPI` & `PayconiqTest` is purposely so, such that confusion about the two will produce an error early on._

## Methods

_These first methods don't need an `apiKey` so all three classes have them._

### **Static QR Sticker**

`createPOSQRCodeURL(posId[, qrCodeOpts])`: returns a url (string) that gives the QR-code with the given `posId` (point-of-sale id) . `posId` must be a string containing only alphanumeric characters, not being longer than 36 characters. The QR-code can be altered with the `qrCodeOpts` object.

### **Invoice**

`createInvoiceURL(invoiceInfo)`: returns a url (string) for a Payconiq invoice. `invoiceInfo` is an object containing three optional entries:

- `amount` (number | string): the amount in eurocents
- `description` (string): a description for the invoice, customer sees this
- `reference` (string): a reference for the invoice, customer does not see this, but can be used for reference in the callback or when fetching payments, or to guarantee uniqueness.

The combination of `amount`, `description`, and `reference` should always be unique to distinguish between invoices and their payed status.

`createInvoiceQRCodeUrl(invoiceInfo[, qrCodeOpts])`: returns a url (string) that gives the QR-code with the given `invoiceInfo` (see `createInvoiceUrl` method). The QR-code can be altered with the `qrCodeOpts` object.
